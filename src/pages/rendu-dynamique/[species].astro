---
import Layout from "../../layouts/Layout.astro";
import penguins from "../../assets/penguins.json";
import * as Plot from "@observablehq/plot";
import PlotFigure from "../../components/PlotFigure.astro";

export const prerender = false;

const { species } = Astro.params;

// Filtrer les pingouins selon l'espèce
const filtered = penguins.filter((p) => p.species === species);

// Configuration du graphique
const plotOptions = {
    grid: true,
    marks: [
        Plot.dot(filtered, {
            x: "culmen_length_mm", // longueur du bec
            y: "body_mass_g", // masse corporelle
            fill: "steelblue",
            r: 5,
        }),
    ],
    x: { label: "Longueur du bec (mm)" },
    y: { label: "Masse corporelle (g)" },
    title: `Relation taille / poids - ${species}`,
};
---

<Layout title={`Espèce : ${species}`}>
    <section class="max-w-5xl mx-auto">
        <!-- Titre et infos -->
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold text-gray-800 mb-3">
                Espèce : <span class="text-blue-600">{species}</span>
            </h1>
            <p class="text-gray-500 text-lg">
                {filtered.length} pingouin(s) trouvé(s) dans le jeu de données
            </p>
        </header>

        <!-- Graphique -->
        <div
            class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-all duration-300"
        >
            <PlotFigure options={plotOptions} />
        </div>

        <!-- Infos complémentaires -->
        <div class="mt-10 bg-blue-50 border border-blue-100 rounded-xl p-6">
            <h2 class="text-2xl font-semibold text-blue-700 mb-2">
                Détails sur le graphique
            </h2>
            <p class="text-gray-700 leading-relaxed">
                Ce graphique illustre la relation entre la <strong
                    >longueur du bec</strong
                > (en mm) et la <strong>masse corporelle</strong> (en grammes) des
                pingouins de l’espèce
                <span class="font-medium text-blue-600">{species}</span>.
            </p>
            <p class="mt-3 text-gray-700 leading-relaxed">
                Chaque point représente un individu, ce qui permet de visualiser
                les variations naturelles au sein de cette espèce.
            </p>
        </div>

        <!-- Bouton retour -->
        <div class="mt-10 text-center">
            <a
                href="/rendu-dynamique"
                class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-6 rounded-lg shadow-md transition-transform hover:-translate-y-0.5"
            >
                ← Retour à la liste des espèces
            </a>
        </div>
    </section>
</Layout>
